name: Talk Weather

on:
  push:
    branches: main
  schedule:
    - cron: "*/2 * * * *"
  workflow_dispatch:

jobs:
  ask-weather:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Get the weather
        run: |
          prompt="Résume la météo à Paris à partir de la réponse suivante: $wttr "
          wttr=$(curl -s https://wttr.in/Paris?format=3)
          echo "$wttr"
          response=$(curl -s "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${{secrets.GEMINI_KEY}}" \
          -H 'Content-Type: application/json' \
          -X POST \
          -d '{
            "contents": [{
              "parts":[{"text": "'"$prompt"'"}]
              }]
            }')
          echo "$response"
